# 1. CUDA 程序加速

## 1.1 核函数内算术强度和访存时间
算术强度指算术操作的工作量（时间）与必要的内存操作的工作量（时间）之比。显然，如果一个计算问题的算术强度越高，加速效果越好。

提高算术强度和降低访存时间是一致的，在计算任务固定的情况下，这可以通过两个手段达到：
- 尽可能减少访存操作的次数
- 通过共享内存、寄存器内存等 CUDA 内存结构的合理使用来提高访存操作的次数。这也是本节讨论的主要内容


## 1.2 SM 驻留线程数和并行规模
SM:Stream Multiprosessor，流多处理器，一个 GPU 中包含众多 SM。要使一个 CUDA 程序达到最优性能，就需要提高每个流处理器能够驻留的线程数量，这和并行规模是息息相关的：并行规模可以定义为一个 GPU 中同时驻留的线程数目，我们可以通过调用核函数时指定 gridDim 和 blockDim 来确定并行规模。可以这样理解：

并行规模是从整个 GPU 处理器的角度看待驻留线程的数量。
SM 中驻留线程的数量则是从更微观角度看待。
影响 SM 中驻留线程数主要有两个因素：

并行规模。当并行规模不够大时，分配每个 SM 的线程数量太少，远远不能达到它能够处理的理论最大线程数，这时我们称 SM 的占有率很低，不能激发 GPU 的最大性能。
资源限制。每个 SM 都具有一定数量的寄存器、共享内存等资源，当我们在核函数中使用这些资源超过一定量时（单个线程使用量超标），SM 就不得不减少其内部驻留的线程数。

SM 总资源 = 单个线程占有资源数 * SM中线程数量

对于并行规模，这是根据具体问题确定的，这也是为什么更大规模的问题更具有利用 GPU 进行并行计算的价值。而对于资源限制，我们将在本章节中详细介绍完 CUDA 内存结构后单开一个话题讨论。